<!doctype html>
<html>
  <head>
	<meta charset="utf-8" />
	<title>Mini App Demo</title>
	<style>
	  body {
		  height: 100dvh;
		  display: grid;
		  grid-template-rows: 5dvh 15dvh 70dvh 10dvh;
		  margin: 0;
		  text-align: center;
		  font-family: sans-serif;
		  font-size: 20px;
	  }

	  body > * {
		  align-content: center;
	  }

	  aside {
		  font-family: monospace;
		  font-size: 0.75rem;
		  background-color: #eee;
	  }

	  header { background-color: #008822; color: #fff; }
	  main { background-color: #f1f1f1; }
	  button {
		  background-color: #881122;
		  color: #fff;
		  border: none;
		  font-size: 3rem;
	  }

	  h1 {
		  padding: 0;
		  margin: 0;
		  font-size: 2rem;
	  }

	  #bg {
		  background-color: #3d3d3d;
		  position: fixed;
		  top: 0;
		  left: 0;
		  align-content: center;
		  right: 0;
		  height: 100dvh;
		  z-index: -1;
	  }

	  main {
		  display: grid;
		  align-content: center;
	  }
	  img { margin: auto; }

	  main, img {
		  max-height: 100%;
		  max-width: 100%;
	  }
	</style>
  </head>
  <body>
	<div id="bg"></div>
	<header>
	  <h1>Лайкни котика :з</h1>
	</header>
	<aside></aside>
	<main>
	  <img src="https://cataas.com/cat" />
	</main>
	<button>
	  ❤️
	</button>
	<script type="module">
	  import bridge from 'https://esm.run/@vkontakte/vk-bridge'

	  bridge.send('VKWebAppInit')

	  const catAvatar = document.querySelector('img')
	  catAvatar.addEventListener('click', () => {
		  bridge.send('VKWebAppAllowNotifications').catch()
	  })
	  const likeBtn = document.querySelector('button')

	  likeBtn.addEventListener('click', (e) => {
		  likeBtn.disabled = true
		  catAvatar.setAttribute('src', `https://cataas.com/cat?time=${Date.now()}`)
		  catAvatar.addEventListener('load', () => { likeBtn.disabled = false })
	  })

	  const cssSupports = JSON.stringify({
	  	vh: window.CSS.supports('height', '100vh'),
	  	dvh: window.CSS.supports('height', '100dvh'),
	  	svh: window.CSS.supports('height', '100svh'),
	  	lvh: window.CSS.supports('height', '100lvh'),
	  })
	  const ua = window.navigator.userAgent

	  document.querySelector('aside').innerHTML = `${ua}<br />${cssSupports}`
	</script>
  </body>
</html>
